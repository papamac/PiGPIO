<?xml version="1.0"?>
<!--
###############################################################################
#                                                                             #
#                            Pi GPIO Indigo Plugin                            #
#                              FILE Devices.xml                               #
#                                                                             #
###############################################################################

  BUNDLE:  Raspberry Pi General Purpose Input/Output for Indigo
           (Pi GPIO.indigoPlugin)
    FILE:  Devices.xml
   TITLE:  Pi GPIO device definitions and ConfigUis
FUNCTION:  Devices.xml defines Pi GPIO device objects, specifies ConfigUis, and
           sets default values for device properties.
   USAGE:  Devices.xml is read and interpreted by the indigo server during
           plugin startup.  When a user creates a new device, indigo uses the
           xml data to instantiate device objects per the indigo object model
           (IOM).  The device object includes a pluginProps dictionary that
           contains the device properties from the xml fields.
  AUTHOR:  papamac
 VERSION:  0.10.0
    DATE:  January 13, 2024

DESCRIPTION:

This xml file contains ConfigUI and States descriptions for four devices:
analogInput, analogOutput, digitalInput, and digitalOutput.  Each ConfigUI is
organized into the following groups of fields:

1. Raspberry Pi Host
2. Device Type and Channel Id
3. Device Configuration
4. Processing
5. Polling and Logging

Many of the field id's are repeated in the four device ConfigUIs.  For ease in
locating the correct one, fields are commented with the device type and field
id.  Custom states for the analog devices follow the ConfigUIs.

CHANGE LOG:

Major changes to the Pi GPIO plugin are described in the CHANGES.md file in the
top level PiGPIO folder.  Changes of lesser importance may be described in
individual module docstrings if appropriate.

v0.5.0  11/28/2021  Fully functional beta version with minimal documentation.
v0.5.4    4/3/2022  Update the digitalInput relayInterrupts label field.
v0.5.8   9/11/2022  Add support for Docker Pi Relay devices and 8/10-bit dacs.
v0.5.9  10/12/2022  Add glitch filter option for built-in GPIO inputs.  Add a
                    "zz" prefix to all label, separator, and title id's so that
                    they sort at the end of a valuesDict print.  Change polling
                    options to logging options for analog and digital output
                    devices.
v0.7.0   2/14/2023  (1) Implement common sensor value processing for both
                    analog input and analog output devices.  Optionally enable
                    change detection, analog on/off thresholding, and limit
                    checking.
                    (2) Add display state selection for analog input and analog
                    output devices.
                    (3) Add turnOn/turnOff sensor values for analog output
                    devices.
                    (4) Change the device types for analog input and analog
                    output devices to custom.  Add/modify the following states:
                        sensorValue,
                        onOffState,
                        limitFault,
                        and limitFaultMessage.
v0.8.0   3/20/2023  (1) Change the device types for analog input and analog
                    output devices from custom types back to sensor and relay
                    types respectively.  Remove the onOffState from the states
                    specification for these devices.
                    (2) Change spacing and commenting in Devices.xml.
v0.8.1   5/13/2023  (1) Add spi bitRate field for MCP3202 device.
                    (2) Change spi bitRate units from kb/s to Mb/s.
v0.9.0    6/8/2023  Add checkSPI, status monitoring, and statusInterval fields
                    to each device ConfigUI.
v0.9.1   6/17/2023  Delete the limitFaultMessage field from the analogInput
                    and analogOutput devices.
v0.10.0  1/13/2024  Replace pigpio with rgpio to accommodate changes in
                    Raspberry Pi 5.  Change the default port number from 8888
                    to 8889 on all devices.  Remove the bounce filter fields
                    in the digital input ConfigUI.
-->

<Devices>

    <!-- ################################################################## -->
    <!-- #                                                                # -->
    <!-- #                      Analog Input Device                       # -->
    <!-- #                                                                # -->
    <!-- ################################################################## -->

    <Device id="analogInput" type="sensor">
        <Name>Analog Input</Name>
        <ConfigUI>

            <!-- ############      analogInput ConfigUI       ############# -->
            <!-- ############      1. Raspberry Pi Host       ############# -->

            <!-- analogInput ConfigUI hostTitle -->

            <Field id="zzHostTitle" type="label" alignText="center">
                <Label>Select Raspberry Pi Host</Label>
            </Field>

            <!-- analogInput ConfigUI hostAddress -->

            <Field id="hostAddress" type="textfield"
                   defaultValue="raspi4b-io.local">
                <Label>Host Address (FQDN or IPv4):</Label>
            </Field>

            <!-- analogInput ConfigUI portNumber -->

            <Field id="portNumber" type="textfield" defaultValue="8889">
                <Label>Port Number (1024-65535):</Label>
            </Field>

            <!-- analogInput ConfigUI hostId -->

            <Field id="hostId" type="textfield" defaultValue="">
                <Label>Host Id:</Label>
            </Field>
            <Field id="zzHostIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>The Host Id is a short, unique code that is used to compactly identify the host.  It may be user specified or automatically assigned from the FQDN (name-id.domainName).</Label>
            </Field>

            <!-- ############      analogInput ConfigUI        ############ -->
            <!-- ############  2. Device Type and Channel Id   ############ -->

            <!-- analogInput ConfigUI selectionSeparator -->

            <Field id="zzSelectionSeparator" type="separator"> </Field>
            <Field id="zzSelectionTitle" type="label" alignText="center">
                <Label>Select ADC Device and Channel</Label>
            </Field>

            <!-- analogInput ConfigUI ioDevType -->

            <Field id="ioDevType" type="menu" defaultValue="MCP3208">
                <Label>ADC Device:</Label>
                <List>
                    <Option value="MCP3202">MCP3202 SPI 2-Channel 12-Bit ADC</Option>
                    <Option value="MCP3204">MCP3204 SPI 4-Channel 12-Bit ADC</Option>
                    <Option value="MCP3208">MCP3208 SPI 8-Channel 12-Bit ADC</Option>
                    <Option value="MCP3422">MCP3422 I2C 2-Channel 18-Bit ADC</Option>
                    <Option value="MCP3423">MCP3423 I2C 2-Channel 18-Bit ADC</Option>
                    <Option value="MCP3424">MCP3423 I2C 4-Channel 18-Bit ADC</Option>
                </List>
            </Field>

            <!-- analogInput ConfigUI spiChannel -->

            <Field id="spiChannel" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>SPI Channel:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>

            <!-- analogInput ConfigUI i2cAddress -->

            <Field id="i2cAddress" type="textfield"  hidden="true"> </Field>
            <Field id="i2cAddress8" type="menu" defaultValue="0x68"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3423, MCP3424)">
                <Label>I2C Address:</Label>
                <List>
                    <Option value="0x68">0x68</Option>
                    <Option value="0x69">0x69</Option>
                    <Option value="0x6a">0x6a</Option>
                    <Option value="0x6b">0x6b</Option>
                    <Option value="0x6c">0x6c</Option>
                    <Option value="0x6d">0x6d</Option>
                    <Option value="0x6e">0x6e</Option>
                    <Option value="0x6f">0x6f</Option>
                </List>
            </Field>

            <!-- analogInput ConfigUI adcChannel -->

            <Field id="adcChannel" type="textfield" hidden="true"> </Field>
            <Field id="adcChannel2" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3422, MCP3423)">
                <Label>ADC Channel Number:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>
            <Field id="adcChannel4" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3204, MCP3424)">
                <Label>ADC Channel Number:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                    <Option value="2">Channel 2</Option>
                    <Option value="3">Channel 3</Option>
                </List>
            </Field>
            <Field id="adcChannel8" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="MCP3208">
                <Label>ADC Channel Number:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                    <Option value="2">Channel 2</Option>
                    <Option value="3">Channel 3</Option>
                    <Option value="4">Channel 4</Option>
                    <Option value="5">Channel 5</Option>
                    <Option value="6">Channel 6</Option>
                    <Option value="7">Channel 7</Option>
                </List>
            </Field>

            <!-- ############      analogInput ConfigUI        ############ -->
            <!-- ############     3. Device Configuration      ############ -->

            <!-- analogInput ConfigUI configSeparator -->

            <Field id="zzConfigSeparator" type="separator"> </Field>
            <Field id="zzConfigTitle" type="label" alignText="center">
                <Label>Configure ADC</Label>
            </Field>

            <!-- analogInput ConfigUI inputConfiguration -->

            <Field id="inputConfiguration" type="menu" defaultValue="1"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Input Configuration:</Label>
                <List>
                    <Option value="1">Single-ended</Option>
                    <Option value="0">Pseudo-differential</Option>
                </List>
            </Field>

            <!-- analogInput ConfigUI referenceVoltage -->

            <Field id="referenceVoltage" type="textfield" defaultValue="4.096"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Reference Voltage (V):</Label>
            </Field>
            <Field id="zzReferenceVoltageLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Enter the internal or external reference voltage for the selected ADC.</Label>
            </Field>

            <!-- analogInput ConfigUI resolution -->

            <Field id="resolution" type="menu" defaultValue="12"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3422, MCP3423, MCP3424)">
                <Label>Resolution:</Label>
                <List>
                    <Option value="12">12 Bits</Option>
                    <Option value="14">14 Bits</Option>
                    <Option value="16">16 Bits</Option>
                    <Option value="18">18 Bits</Option>
                </List>
            </Field>

            <!-- analogInput ConfigUI gain -->

            <Field id="gain" type="menu" defaultValue="1"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3422, MCP3423, MCP3424)">
                <Label>PGA Gain:</Label>
                <List>
                    <Option value="1">1X Gain</Option>
                    <Option value="2">2X Gain</Option>
                    <Option value="4">4X Gain</Option>
                    <Option value="8">8X Gain</Option>
                </List>
            </Field>

            <!-- analogInput ConfigUI scalingFactor -->

            <Field id="scalingFactor" type="textfield" defaultValue="2.47058824">
                <Label>Scaling Factor:</Label>
            </Field>
            <Field id="zzScalingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>The Scaling Factor is used to calibrate an analog input device.
                    It multiplies all raw values read from the ADC.</Label>
            </Field>

            <!-- analogInput ConfigUI units -->

            <Field id="units" type="menu" defaultValue=" ">
                <Label>Sensor Value Units:</Label>
                <List>
                    <Option value=" ">None</Option>
                    <Option value="V">Volts (V)</Option>
                    <Option value="mV">Milivolts (mV)</Option>
                    <Option value="µV">Microvolts (µV)</Option>
                    <Option value="A">Amperes (A)</Option>
                    <Option value="mA">Miliamps (mA)</Option>
                    <Option value="µA">Microamps (µA)</Option>
                    <Option value="W">Watts (W)</Option>
                    <Option value="mW">Miliwatts (mW)</Option>
                    <Option value="µW">Microwatts (µW)</Option>
                    <Option value="°F">Degrees Fahrenheit (°F)</Option>
                    <Option value="°C">Degrees Celsius (°C)</Option>
                </List>
            </Field>

            <!-- analogInput ConfigUI bitRate -->

            <Field id="bitRate" type="textfield" defaultValue="2.0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>SPI Bit Rate (0.1-10.0 Mb/s):</Label>
            </Field>
            <Field id="zzBitRateLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Specify the SPI data transfer rate for this device.
                    The bit rate in Mb/s is equal to the SPI clock rate in MHz.</Label>
            </Field>

            <!-- analogInput ConfigUI checkSPI -->

            <Field id="checkSPI" type="checkbox" defaultValue="false"
                    visibleBindingId="ioDevType"
                    visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Check SPI Integrity:</Label>
            </Field>
            <Field id="checkLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Check SPI integrity by repeating each SPI device read.
                    Log a warning if consecutive analog reads differ by more than 10 counts.
                    If this persists, the SPI bit rate may be too high for the device.</Label>
            </Field>

            <!-- ############      analogInput ConfigUI        ############ -->
            <!-- ############          4. Processing           ############ -->

            <!-- analogInput ConfigUI processingSeparator -->

            <Field id="zzProcessingSeparator" type="separator"> </Field>
            <Field id="zzProcessingTitle" type="label" alignText="center">
                <Label>Select Display and Processing Options</Label>
            </Field>

            <!-- analogInput ConfigUI displayStateId -->

            <Field id="displayStateId" type="menu" defaultValue="sensorValue">
                <Label>Display State:</Label>
                <List>
                    <Option value="sensorValue">Sensor Value</Option>
                    <Option value="onOffState">On/Off State</Option>
                </List>
            </Field>
            <Field id="zzDisplayStateIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Select the state to display in the Indigo Home window.</Label>
            </Field>

            <!-- analogInput ConfigUI changeThreshold -->

            <Field id="changeThreshold" type="textfield" defaultValue="None">
                <Label>Change Detection Threshold (percent or None):</Label>
            </Field>
            <Field id="zzChangeThresholdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter a percentage threshold for change detection or None if no change detection is desired.</Label>
            </Field>

            <!-- analogInput ConfigUI onThreshold -->

            <Field id="onThreshold" type="textfield" defaultValue="None">
                <Label>Analog On Threshold (units or None):</Label>
            </Field>
            <Field id="zzOnThresholdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter an analog on threshold for the onOffState or None if no onOffState is desired.</Label>
            </Field>

            <!-- analogInput ConfigUI lowLimit -->

            <Field id="lowLimit" type="textfield" defaultValue="None">
                <Label>Low Limit (units or None):</Label>
            </Field>
            <Field id="zzLowLimitLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter a low limit for limit checking or None if no low limit checking is desired.</Label>
            </Field>

            <!-- analogInput ConfigUI highLimit -->

            <Field id="highLimit" type="textfield" defaultValue="None">
                <Label>High Limit (units or None):</Label>
            </Field>
            <Field id="zzHighLimitLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter a high limit for limit checking or None if no high limit checking is desired.</Label>
            </Field>

            <!-- ############      analogInput ConfigUI        ############ -->
            <!-- ############     5. Polling and Logging       ############ -->

            <!-- analogInput ConfigUI pollingSeparator -->

            <Field id="zzPollingSeparator" type="separator"> </Field>
            <Field id="zzPollingTitle" type="label" alignText="center">
                <Label>Select Polling and Logging Options</Label>
            </Field>

            <!-- analogInput ConfigUI polling -->

            <Field id="polling" type="checkbox" defaultValue="false">
                <Label>Enable Input Polling:</Label>
            </Field>
            <Field id="zzPollingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Read the sensor value at regular intervals and log it if it changed.</Label>
            </Field>
            <Field id="pollingInterval" type="textfield" defaultValue="10"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Polling Interval (seconds):</Label>
            </Field>
            <Field id="zzPollingIntervalLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Setting the interval to 0 reads the sensor value in each pass through the run loop.
                    The actual polling interval depends on the run loop time.</Label>
            </Field>

            <!-- analogInput ConfigUI logAll -->

            <Field id="logAll" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log All Polling Results:</Label>
            </Field>
            <Field id="zzLogAllLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log the sensor value after each poll regardless of change.
                    By default, only changed values are logged.</Label>
            </Field>

            <!-- analogInput ConfigUI monitorStatus -->

            <Field id="monitorStatus" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Monitor Polling Status:</Label>
            </Field>
            <Field id="zzMonitorStatusLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Compute and log the average polling interval and rate over the period of the status interval.</Label>
            </Field>
            <Field id="statusInterval" type="textfield" defaultValue="10.0"
                   visibleBindingId="monitorStatus" visibleBindingValue="true">
                <Label>Status Monitoring Interval (minutes):</Label>
            </Field>

        </ConfigUI>

        <States>

            <!-- ############        analogInput States        ############ -->

            <!-- analogInput States sensorValue -->

            <State id="sensorValue">
                <ValueType>Number</ValueType>
                <TriggerLabel>Sensor Value</TriggerLabel>
				<ControlPageLabel>Sensor Value</ControlPageLabel>
            </State>

            <!-- analogInput States changeDetected -->

            <State id="changeDetected">
                <ValueType boolType="TrueFalse">Boolean</ValueType>
                <TriggerLabel>Sensor Value Change Detected</TriggerLabel>
				<ControlPageLabel>Sensor Value Change Detected</ControlPageLabel>
            </State>

            <!-- analogInput States limitFault -->

            <State id="limitFault">
                <ValueType boolType="TrueFalse">Boolean</ValueType>
                <TriggerLabel>Sensor Value Limit Fault</TriggerLabel>
				<ControlPageLabel>Sensor Value Limit Fault</ControlPageLabel>
            </State>

        </States>
    </Device>

    <!-- ################################################################## -->
    <!-- #                                                                # -->
    <!-- #                     Analog Output Device                       # -->
    <!-- #                                                                # -->
    <!-- ################################################################## -->

    <Device id="analogOutput" type="relay">
        <Name>Analog Output</Name>
        <ConfigUI>

            <!-- ############       analogOutput ConfigUI      ############ -->
            <!-- ############       1. Raspberry Pi Host       ############ -->

            <!-- analogOutput ConfigUI hostTitle -->

            <Field id="zzHostTitle" type="label" alignText="center">
                <Label>Select Raspberry Pi Host</Label>
            </Field>

            <!-- analogOutput ConfigUI hostAddress -->

            <Field id="hostAddress" type="textfield"
                   defaultValue="raspi4b-io.local">
                <Label>Host Address (FQDN or IPv4):</Label>
            </Field>

            <!-- analogOutput ConfigUI portNumber -->

            <Field id="portNumber" type="textfield" defaultValue="8889">
                <Label>Port Number (1024-65535):</Label>
            </Field>

            <!-- analogOutput ConfigUI hostId -->

            <Field id="hostId" type="textfield" defaultValue="">
                <Label>Host Id:</Label>
            </Field>
            <Field id="zzHostIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>The Host Id is a short, unique code that is used to compactly identify the host.  It may be user specified or automatically assigned from the FQDN (name-id.domainName).</Label>
            </Field>

            <!-- ############       analogOutput ConfigUI      ############ -->
            <!-- ############  2. Device Type and Channel Id   ############ -->

            <!-- analogOutput ConfigUI selectionSeparator -->

            <Field id="zzSelectionSeparator" type="separator"> </Field>
            <Field id="zzSelectionTitle" type="label" alignText="center">
                <Label>Select DAC Device and Channel</Label>
            </Field>

            <!-- analogOutput ConfigUI ioDevType -->

            <Field id="ioDevType" type="menu" defaultValue="MCP4822">
                <Label>DAC Device:</Label>
                <List>
                    <Option value="MCP4801">MCP4801 SPI Single Channel 8-Bit DAC</Option>
                    <Option value="MCP4802">MCP4802 SPI Dual Channel 8-Bit DAC</Option>
                    <Option value="MCP4811">MCP4811 SPI Single Channel 10-Bit DAC</Option>
                    <Option value="MCP4812">MCP4812 SPI Dual Channel 10-Bit DAC</Option>
                    <Option value="MCP4821">MCP4821 SPI Single Channel 12-Bit DAC</Option>
                    <Option value="MCP4822">MCP4822 SPI Dual Channel 12-Bit DAC</Option>
                </List>
            </Field>

            <!-- analogOutput ConfigUI spiChannel -->

            <Field id="spiChannel" type="menu" defaultValue="0">
                <Label>SPI Channel:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>

             <!-- analogOutput ConfigUI dacChannel -->

            <Field id="dacChannel" type="textfield" hidden="true"> </Field>
            <Field id="dacChannel1" type="textfield" defaultValue="0"
                   hidden="true"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP4801, MCP4811, MCP4821)">
            </Field>
            <Field id="dacChannel2" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP4802, MCP4812, MCP4822)">
                <Label>DAC Channel:</Label>
                <List>
                    <Option value="0">Channel 0 (Output A)</Option>
                    <Option value="1">Channel 1 (Output B)</Option>
                </List>
            </Field>

            <!-- ############       analogOutput ConfigUI      ############ -->
            <!-- ############      3. Device Configuration     ############ -->

            <!-- analogOutput ConfigUI configSeparator -->

            <Field id="zzConfigSeparator" type="separator"> </Field>
            <Field id="zzConfigTitle" type="label" alignText="center">
                <Label>Configure DAC</Label>
            </Field>

            <!-- analogOutput ConfigUI gain -->

            <Field id="gain" type="menu" defaultValue="1">
                <Label>Gain:</Label>
                <List>
                    <Option value="1">1X Gain - output range of 0-2.048 V</Option>
                    <Option value="2">2X Gain - output range of 0-4.096 V</Option>
                </List>
            </Field>

            <!-- analogOutput ConfigUI scalingFactor -->

            <Field id="scalingFactor" type="textfield" defaultValue="1.0">
                <Label>Scaling Factor:</Label>
            </Field>
            <Field id="zzScalingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>The Scaling Factor is used to calibrate an analog output device.
                    It divides all sensor values written to the DAC.</Label>
            </Field>

            <!-- analogOutput ConfigUI units -->

            <Field id="units" type="menu" defaultValue=" ">
                <Label>Sensor Value Units:</Label>
                <List>
                    <Option value=" ">None</Option>
                    <Option value="V">Volts (V)</Option>
                    <Option value="mV">Milivolts (mV)</Option>
                    <Option value="µV">Microvolts (µV)</Option>
                    <Option value="A">Amperes (A)</Option>
                    <Option value="mA">Miliamps (mA)</Option>
                    <Option value="µA">Microamps (µA)</Option>
                    <Option value="W">Watts (W)</Option>
                    <Option value="mW">Miliwatts (mW)</Option>
                    <Option value="µW">Microwatts (µW)</Option>
                    <Option value="°F">Degrees Fahrenheit (°F)</Option>
                    <Option value="°C">Degrees Celsius (°C)</Option>
                </List>
            </Field>

            <!-- analogOutput ConfigUI bitRate -->

            <Field id="bitRate" type="textfield" defaultValue="2.0">
                <Label>SPI Bit Rate (0.1-10.0 Mb/s):</Label>
            </Field>
            <Field id="zzBitRateLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Specify the SPI data transfer rate for this device.
                    The bit rate in Mb/s is equal to the SPI clock rate in MHz.</Label>
            </Field>

            <!-- ############      analogOutput ConfigUI       ############ -->
            <!-- ############          4. Processing           ############ -->

            <!-- analogOutput ConfigUI processingSeparator -->

            <Field id="zzProcessingSeparator" type="separator"> </Field>
            <Field id="zzProcessingTitle" type="label" alignText="center">
                <Label>Select Display and Processing Options</Label>
            </Field>

            <!-- analogOutput ConfigUI displayStateId -->

            <Field id="displayStateId" type="menu" defaultValue="sensorValue">
                <Label>Display State:</Label>
                <List>
                    <Option value="sensorValue">Sensor Value</Option>
                    <Option value="onOffState">On/Off State</Option>
                </List>
            </Field>
            <Field id="zzDisplayStateIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Select the state to display in the Indigo Home window.</Label>
            </Field>

            <!-- analogOutput ConfigUI changeThreshold -->

            <Field id="changeThreshold" type="textfield" defaultValue="None">
                <Label>Change Detection Threshold (percent or None):</Label>
            </Field>
            <Field id="zzChangeThresholdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter a percentage threshold for change detection or None if no change detection is desired.</Label>
            </Field>

            <!-- analogOutput ConfigUI onThreshold -->

            <Field id="onThreshold" type="textfield" defaultValue="None">
                <Label>Analog On Threshold (units or None):</Label>
            </Field>
            <Field id="zzOnThresholdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter an analog on threshold for the onOffState or None if no onOffState is desired.</Label>
            </Field>

            <!-- analogOutput ConfigUI lowLimit -->

            <Field id="lowLimit" type="textfield" defaultValue="None">
                <Label>Low Limit (units or None):</Label>
            </Field>
            <Field id="zzLowLimitLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter a low limit for limit checking or None if no low limit checking is desired.</Label>
            </Field>

             <!-- analogOutput ConfigUI highLimit -->

            <Field id="highLimit" type="textfield" defaultValue="None">
                <Label>High Limit (units or None):</Label>
            </Field>
            <Field id="zzHighLimitLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter a high limit for limit checking or None if no high limit checking is desired.</Label>
            </Field>

            <!-- analogOutput ConfigUI turnOnValue -->

            <Field id="turnOnValue" type="textfield" defaultValue="None">
                <Label>Turn On Sensor Value (units or None):</Label>
            </Field>
            <Field id="zzTurnOnValueLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter a sensor value to write in a turn on action, or None if no turn on is desired.</Label>
            </Field>

             <!-- analogOutput ConfigUI turnOffValue -->

            <Field id="turnOffValue" type="textfield" defaultValue="None">
                <Label>Turn Off Sensor Value (units or None):</Label>
            </Field>
            <Field id="zzTurnOffValueLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Enter a sensor value to write in a turn off action, or None if no turn off is desired.</Label>
            </Field>

            <!-- ############      analogOutput ConfigUI       ############ -->
            <!-- ############      5. Polling and Logging      ############ -->

            <!-- analogOutput ConfigUI loggingSeparator -->

            <Field id="zzPollingSeparator" type="separator"> </Field>
            <Field id="zzPollingTitle" type="label" alignText="center">
                <Label>Select Polling and Logging Options</Label>
            </Field>

            <!-- analogOutput ConfigUI polling -->

            <Field id="polling" type="checkbox" defaultValue="false">
                <Label>Enable Output Polling:</Label>
            </Field>
            <Field id="zzPollingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Get the sensor value at regular intervals and log it if it changed.  If possible, read the value from the output device; if not, fetch it from the device states dictionary.</Label>
            </Field>
            <Field id="pollingInterval" type="textfield" defaultValue="10"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Polling Interval (seconds):</Label>
            </Field>
            <Field id="zzPollingIntervalLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                 <Label>Setting the interval to 0 gets the output sensor value in each pass through the run loop.
                    The actual polling interval depends on the run loop time.</Label>
            </Field>

            <!-- analogOutput ConfigUI logAll -->

            <Field id="logAll" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log All Polling Results:</Label>
            </Field>
            <Field id="zzLogAllLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log the output sensor value after each poll regardless of change.
                    By default, only changed values are logged.</Label>
            </Field>

            <!-- analogOutput ConfigUI monitorStatus -->

            <Field id="monitorStatus" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Monitor Polling Status:</Label>
            </Field>
            <Field id="zzMonitorStatusLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Compute and log the average polling interval and rate over the period of the status interval.</Label>
            </Field>
            <Field id="statusInterval" type="textfield" defaultValue="10.0"
                   visibleBindingId="monitorStatus" visibleBindingValue="true">
                <Label>Status Monitoring Interval (minutes):</Label>
            </Field>

        </ConfigUI>

        <States>

            <!-- ############       analogOutput States        ############ -->

            <!-- analogOutput States sensorValue -->

            <State id="sensorValue">
                <ValueType>Number</ValueType>
                <TriggerLabel>Sensor Value</TriggerLabel>
				<ControlPageLabel>Sensor Value</ControlPageLabel>
            </State>

            <!-- analogOutput States changeDetected -->

            <State id="changeDetected">
                <ValueType boolType="TrueFalse">Boolean</ValueType>
                <TriggerLabel>Sensor Value Change Detected</TriggerLabel>
				<ControlPageLabel>Sensor Value Change Detected</ControlPageLabel>
            </State>

            <!-- analogOutput States limitFault -->

            <State id="limitFault">
                <ValueType boolType="TrueFalse">Boolean</ValueType>
                <TriggerLabel>Sensor Value Limit Fault</TriggerLabel>
				<ControlPageLabel>Sensor Value Limit Fault</ControlPageLabel>
            </State>

        </States>
    </Device>

    <!-- ################################################################## -->
    <!-- #                                                                # -->
    <!-- #                     Digital Input Device                       # -->
    <!-- #                                                                # -->
    <!-- ################################################################## -->

    <Device id="digitalInput" type="sensor">
        <Name>Digital Input</Name>
        <ConfigUI>

            <!-- ############      Digital Input ConfigUI      ############ -->
            <!-- ############       1. Raspberry Pi Host       ############ -->

            <!-- digitalInput ConfigUI hostTitle-->

            <Field id="zzHostTitle" type="label" alignText="center">
                <Label>Select Raspberry Pi Host</Label>
            </Field>

            <!-- digitalInput ConfigUI hostAddress -->

            <Field id="hostAddress" type="textfield"
                   defaultValue="raspi4b-io.local">
                <Label>Host Address (FQDN or IPv4):</Label>
            </Field>

            <!-- digitalInput ConfigUI portNumber -->

            <Field id="portNumber" type="textfield" defaultValue="8889">
                <Label>Port Number (1024-65535):</Label>
            </Field>

            <!-- digitalInput ConfigUI hostId -->

            <Field id="hostId" type="textfield" defaultValue="">
                <Label>Host Id:</Label>
            </Field>
            <Field id="zzHostIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>The Host Id is a short, unique code that is used to compactly identify the host.  It may be user specified or automatically assigned from the FQDN (name-id.domainName).</Label>
            </Field>

            <!-- ############      Digital Input ConfigUI      ############ -->
            <!-- ############  2. Device Type and Channel Id   ############ -->

            <!-- digitalInput ConfigUI selectionSeparator -->

            <Field id="zzSelectionSeparator" type="separator"> </Field>
            <Field id="zzSelectionTitle" type="label" alignText="center">
                <Label>Select Digital Input Device and GPIO Bit</Label>
            </Field>

            <!-- digitalInput ConfigUI ioDevType -->

            <Field id="ioDevType" type="menu" defaultValue="pigpio">
                <Label>Digital Input Device:</Label>
                <List>
                    <Option value="pigpio">Built-in Raspberry Pi GPIO</Option>
                    <Option value="MCP23008">MCP23008 I2C 8-Bit I/O Expander</Option>
                    <Option value="MCP23017">MCP23017 I2C 16-Bit I/O Expander</Option>
                    <Option value="MCP23S08">MCP23S08 SPI 8-Bit I/O Expander</Option>
                    <Option value="MCP23S17">MCP23S17 SPI 16-Bit I/O Expander</Option>
                </List>
            </Field>

            <!-- digitalInput ConfigUI gpioNumber -->

            <Field id="gpioNumber" type="menu" defaultValue="17"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>BCM GPIO Number:</Label>
                <List>
                    <Option value="4">GPIO 4</Option>
                    <Option value="5">GPIO 5</Option>
                    <Option value="6">GPIO 6</Option>
                    <Option value="12">GPIO 12</Option>
                    <Option value="13">GPIO 13</Option>
                    <Option value="16">GPIO 16</Option>
                    <Option value="17">GPIO 17</Option>
                    <Option value="18">GPIO 18</Option>
                    <Option value="19">GPIO 19</Option>
                    <Option value="20">GPIO 20</Option>
                    <Option value="21">GPIO 21</Option>
                    <Option value="22">GPIO 22</Option>
                    <Option value="23">GPIO 23</Option>
                    <Option value="24">GPIO 24</Option>
                    <Option value="25">GPIO 25</Option>
                    <Option value="26">GPIO 26</Option>
                    <Option value="27">GPIO 27</Option>
                </List>
            </Field>

            <!-- digitalInput ConfigUI i2cAddress -->

            <Field id="i2cAddress" type="textfield"  hidden="true"> </Field>
            <Field id="i2cAddress8" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017)">
                <Label>I2C Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                    <Option value="0x24">0x24</Option>
                    <Option value="0x25">0x25</Option>
                    <Option value="0x26">0x26</Option>
                    <Option value="0x27">0x27</Option>
                </List>
            </Field>

            <!-- digitalInput ConfigUI spiChannel -->

            <Field id="spiChannel" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI Channel:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>

            <!-- digitalInput ConfigUI spiDeviceAddress -->

            <Field id="spiDevAddress" type="textfield" defaultValue="0x20"
                   hidden="true"> </Field>
            <Field id="spiDevAddress4" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType" visibleBindingValue="MCP23S08">
                <Label>SPI Device Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                </List>
            </Field>
            <Field id="spiDevAddress8" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType" visibleBindingValue="MCP23S17">
                <Label>SPI Device Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                    <Option value="0x24">0x24</Option>
                    <Option value="0x25">0x25</Option>
                    <Option value="0x26">0x26</Option>
                    <Option value="0x27">0x27</Option>
                </List>
            </Field>

            <!-- digitalInput ConfigUI ioPort -->

            <Field id="ioPort" type="menu" defaultValue="a"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23017, MCP23S17)">
                <Label>16-Bit I/O Expander Port:</Label>
                <List>
                    <Option value="a">Port A</Option>
                    <Option value="b">Port B</Option>
                </List>
            </Field>

            <!-- digitalInput ConfigUI bitNumber -->

            <Field id="bitNumber" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>I/O Port Bit Number:</Label>
                <List>
                    <Option value="0">Bit 0</Option>
                    <Option value="1">Bit 1</Option>
                    <Option value="2">Bit 2</Option>
                    <Option value="3">Bit 3</Option>
                    <Option value="4">Bit 4</Option>
                    <Option value="5">Bit 5</Option>
                    <Option value="6">Bit 6</Option>
                    <Option value="7">Bit 7</Option>
                </List>
            </Field>

            <!-- ############      Digital Input ConfigUI      ############ -->
            <!-- ##############   3. Device Configuration    ############## -->

            <!-- digitalInput ConfigUI configSeparator -->

            <Field id="zzConfigSeparator" type="separator"> </Field>
            <Field id="zzConfigTitle" type="label" alignText="center">
                <Label>Configure Digital Input</Label>
            </Field>

            <!-- digitalInput ConfigUI invert -->

            <Field id="invert" type="checkbox" defaultValue="false">
                <Label>Invert On/Off State:</Label>
            </Field>
            <Field id="zzInvertLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>If checked, the on/off state is set to on for logic low and to off for logic high.</Label>
            </Field>

            <!-- digitalInput ConfigUI pullup -->

            <Field id="pullup" type="textfield" defaultValue="off"
                   hidden="true"> </Field>
            <Field id="pullup1" type="menu" defaultValue="off"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>Internal Input Bias:</Label>
                <List>
                    <Option value="off">Open (no bias)</Option>
                    <Option value="up">Pull up to logic high</Option>
                    <Option value="down">Pull down to logic low</Option>
                </List>
            </Field>
            <Field id="zzPullup1Label" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>Open applies no bias to the digital input. Pull up or down biases the input to logic high or low through an internal resistor.</Label>
            </Field>
            <Field id="pullup2" type="menu" defaultValue="off"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>Internal Input Bias:</Label>
                <List>
                    <Option value="off">Open (no bias)</Option>
                    <Option value="up">Pull up to logic high</Option>
                </List>
            </Field>
            <Field id="zzPullup2Label" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>Open applies no bias to the digital input. Pull up biases the input to logic high through an internal resistor.</Label>
            </Field>

            <!-- digitalInput ConfigUI bitRate -->

            <Field id="bitRate" type="textfield" defaultValue="10.0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI Bit Rate (0.1-10.0 Mb/s):</Label>
            </Field>
            <Field id="zzBitRateLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>Specify the SPI data transfer rate for this device.
                    The bit rate in Mb/s is equal to the SPI clock rate in MHz.</Label>
            </Field>

            <!-- digitalInput ConfigUI checkSPI -->

            <Field id="checkSPI" type="checkbox" defaultValue="false"
                    visibleBindingId="ioDevType"
                    visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>Check SPI Integrity:</Label>
            </Field>
            <Field id="checkLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>Check SPI integrity by repeating each SPI device read.
                    Log a warning if the consecutive reads differ.
                    If this persists, the SPI bit rate may be too high for the device.</Label>
            </Field>

            <!-- ############      Digital Input ConfigUI      ############ -->
            <!-- ##############        4. Processing         ############## -->

             <!-- digitalInput ConfigUI interruptSeparator -->

            <Field id="zzInterruptSeparator" type="separator"> </Field>
            <Field id="zzInterruptTitle" type="label" alignText="center">
                <Label>Select Interrupt and Filter Options</Label>
            </Field>

            <!-- digitalInput ConfigUI callback -->

            <Field id="callback" type="checkbox" defaultValue="false"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>Use GPIO Callback:</Label>
            </Field>
            <Field id="zzCallbackLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>The GPIO callback updates/logs the device state on an input state change.  It eliminates the need for polling to detect changes.  It also enables interrupt relay and debounce filtering if requested.</Label>
            </Field>

            <!-- digitalInput ConfigUI glitchFilter -->

            <Field id="glitchFilter" type="checkbox" defaultValue="false"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>Enable Glitch Filter:</Label>
            </Field>
            <Field id="zzGlitchFilterLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>The glitch filter rejects callback state changes that are not stable for longer than the glitch time.  The callback is delayed by the glitch time.</Label>
            </Field>
            <Field id="glitchTime" type="textfield" defaultValue="10"
                   visibleBindingId="glitchFilter" visibleBindingValue="true">
                <Label>Glitch Time (µsec):</Label>
            </Field>
            <Field id="zzGlitchTimeLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="glitchFilter" visibleBindingValue="true">
                <Label>The glitch time should be as short as possible, but long enough to eliminate short, spurious glitches.</Label>
            </Field>

            <!-- digitalInput ConfigUI relayInterrupts -->

            <Field id="relayInterrupts" type="checkbox" defaultValue="false"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>Relay Hardware Interrupts:</Label>
            </Field>
            <Field id="zzRelayInterruptsLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>Indicates that this GPIO input is connected to hardware interrupt outputs from one or more interrupt devices.  A transition on this GPIO causes the callback method to relay the interrupt to all interrupt devices.</Label>
            </Field>

            <!-- digitalInput ConfigUI hardwareInterrupt -->

            <Field id="hardwareInterrupt" type="checkbox" defaultValue="false"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>Enable Hardware Interrupt:</Label>
            </Field>
            <Field id="zzHardwareInterruptLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="hardwareInterrupt"
                   visibleBindingValue="true">
                <Label>Enabling hardware interrupt raises a hardware interrupt output on an input state change.  The interrupt output must be connected to a GPIO input that is configured for callback and interrupt relay.</Label>
            </Field>
            <Field id="interruptRelayGPIO" type="menu"
                   visibleBindingId="hardwareInterrupt"
                   visibleBindingValue="true">
                <Label>Select Interrupt Relay GPIO:</Label>
                <List class="self" method="getGPIORelayDevices"
                      dynamicReload="yes"/>
            </Field>

            <!-- ############      Digital Input ConfigUI      ############ -->
            <!-- ############      5. Polling and Logging      ############ -->

            <!-- digitalInput ConfigUI pollingSeparator -->

            <Field id="zzPollingSeparator" type="separator"> </Field>
            <Field id="zzPollingTitle" type="label" alignText="center">
                <Label>Select Polling and Logging Options</Label>
            </Field>

            <!-- digitalInput ConfigUI polling -->

            <Field id="polling" type="checkbox" defaultValue="false">
                <Label>Enable Input Polling:</Label>
            </Field>
            <Field id="zzPollingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Read the input state at regular intervals and log it if it has changed.</Label>
            </Field>
            <Field id="pollingInterval" type="textfield" defaultValue="0"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Polling Interval (seconds):</Label>
            </Field>
            <Field id="zzPollingIntervalLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                 <Label>Setting the interval to 0 reads the input state in each pass through the run loop.
                    The actual polling interval depends on the run loop time.</Label>
            </Field>

            <!-- digitalInput ConfigUI logAll -->

            <Field id="logAll" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log All Polling Results:</Label>
            </Field>
            <Field id="zzLogAllLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log the input state after each poll regardless of change.
                    By default, only changed states are logged.</Label>
            </Field>

            <!-- digitalInput ConfigUI monitorStatus -->

            <Field id="monitorStatus" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Monitor Polling Status:</Label>
            </Field>
            <Field id="zzMonitorStatusLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Compute and log the average polling interval and rate over the period of the status interval.</Label>
            </Field>
            <Field id="statusInterval" type="textfield" defaultValue="10.0"
                   visibleBindingId="monitorStatus" visibleBindingValue="true">
                <Label>Status Monitoring Interval (minutes):</Label>
            </Field>

        </ConfigUI>
    </Device>

    <!-- ################################################################## -->
    <!-- #                                                                # -->
    <!-- #                     Digital Output Device                      # -->
    <!-- #                                                                # -->
    <!-- ################################################################## -->

    <Device id="digitalOutput" type="relay">
        <Name>Digital Output</Name>
        <ConfigUI>

            <!-- ############     Digital Output ConfigUI      ############ -->
            <!-- ############       1. Raspberry Pi Host       ############ -->

            <!-- digitalOutput hostTitle -->

            <Field id="zzHostTitle" type="label" alignText="center">
                <Label>Select Raspberry Pi Host</Label>
            </Field>

             <!-- digitalOutput ConfigUI hostAddress -->

            <Field id="hostAddress" type="textfield"
                   defaultValue="raspi4b-io.local">
                <Label>Host Address (FQDN or IPv4):</Label>
            </Field>

            <!-- digitalOutput ConfigUI portNumber -->

            <Field id="portNumber" type="textfield" defaultValue="8889">
                <Label>Port Number (1024-65535):</Label>
            </Field>

             <!-- digitalOutput ConfigUI hostId -->

            <Field id="hostId" type="textfield" defaultValue="">
                <Label>Host Id:</Label>
            </Field>
            <Field id="zzHostIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>The Host Id is a short, unique code that is used to compactly identify the host.  It may be user specified or automatically assigned from the FQDN (name-id.domainName).</Label>
            </Field>

            <!-- ############     Digital Output ConfigUI      ############ -->
            <!-- ############  2. Device Type and Channel Id   ############ -->

             <!-- digitalOutput ConfigUI selectionSeparator -->

            <Field id="zzSelectionSeparator" type="separator"> </Field>
            <Field id="zzSelectionTitle" type="label" alignText="center">
                <Label>Select Digital Output Device and GPIO Bit / Relay</Label>
            </Field>

             <!-- digitalOutput ConfigUI ioDevType -->

            <Field id="ioDevType" type="menu" defaultValue="pigpio">
                <Label>Digital Output Device:</Label>
                <List>
                    <Option value="pigpio">Built-in Raspberry Pi GPIO</Option>
                    <Option value="dkrPiRly">I2C Docker Pi Relay</Option>
                    <Option value="MCP23008">MCP23008 I2C 8-Bit I/O Expander</Option>
                    <Option value="MCP23017">MCP23017 I2C 16-Bit I/O Expander</Option>
                    <Option value="MCP23S08">MCP23S08 SPI 8-Bit I/O Expander</Option>
                    <Option value="MCP23S17">MCP23S17 SPI 16-Bit I/O Expander</Option>
                </List>
            </Field>

             <!-- digitalOutput ConfigUI gpioNumber -->

            <Field id="gpioNumber" type="menu" defaultValue="17"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>BCM GPIO Number:</Label>
                <List>
                    <Option value="4">GPIO 4</Option>
                    <Option value="5">GPIO 5</Option>
                    <Option value="6">GPIO 6</Option>
                    <Option value="12">GPIO 12</Option>
                    <Option value="13">GPIO 13</Option>
                    <Option value="16">GPIO 16</Option>
                    <Option value="17">GPIO 17</Option>
                    <Option value="18">GPIO 18</Option>
                    <Option value="19">GPIO 19</Option>
                    <Option value="20">GPIO 20</Option>
                    <Option value="21">GPIO 21</Option>
                    <Option value="22">GPIO 22</Option>
                    <Option value="23">GPIO 23</Option>
                    <Option value="24">GPIO 24</Option>
                    <Option value="25">GPIO 25</Option>
                    <Option value="26">GPIO 26</Option>
                    <Option value="27">GPIO 27</Option>
                </List>
            </Field>

            <!-- digitalOutput ConfigUI i2cAddress -->

            <Field id="i2cAddress" type="textfield"  hidden="true"> </Field>
            <Field id="i2cAddress4" type="menu" defaultValue="0x10"
                   visibleBindingId="ioDevType" visibleBindingValue="dkrPiRly">
                <Label>I2C Address:</Label>
                <List>
                    <Option value="0x10">0x10</Option>
                    <Option value="0x11">0x11</Option>
                    <Option value="0x12">0x12</Option>
                    <Option value="0x13">0x13</Option>
                </List>
            </Field>
            <Field id="i2cAddress8" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017)">
                <Label>I2C Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                    <Option value="0x24">0x24</Option>
                    <Option value="0x25">0x25</Option>
                    <Option value="0x26">0x26</Option>
                    <Option value="0x27">0x27</Option>
                </List>
            </Field>

            <!--  digitalOutput ConfigUI relayNumber  -->

            <Field id="relayNumber" type="menu" defaultValue="1"
                   visibleBindingId="ioDevType" visibleBindingValue="dkrPiRly">
                <Label>Relay Number:</Label>
                <List>
                    <Option value="1">Relay 1</Option>
                    <Option value="2">Relay 2</Option>
                    <Option value="3">Relay 3</Option>
                    <Option value="4">Relay 4</Option>
                </List>
            </Field>

            <!-- digitalOutput ConfigUI spiChannel -->

            <Field id="spiChannel" type="menu" visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI Channel:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>

            <!-- digitalOutput ConfigUI spiDevAddress -->

            <Field id="spiDevAddress" type="textfield" hidden="true"> </Field>
            <Field id="spiDevAddress4" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType" visibleBindingValue="MCP23S08">
                <Label>SPI Device Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                </List>
            </Field>
            <Field id="spiDevAddress8" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType" visibleBindingValue="MCP23S17">
                <Label>SPI Device Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                    <Option value="0x24">0x24</Option>
                    <Option value="0x25">0x25</Option>
                    <Option value="0x26">0x26</Option>
                    <Option value="0x27">0x27</Option>
                </List>
            </Field>

            <!-- digitalOutput ConfigUI ioPort -->

            <Field id="ioPort" type="menu" defaultValue="a"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23017, MCP23S17)">
                <Label>16-Bit I/O Expander Port:</Label>
                <List>
                    <Option value="a">Port A</Option>
                    <Option value="b">Port B</Option>
                </List>
            </Field>

            <!-- digitalOutput ConfigUI bitNumber -->

            <Field id="bitNumber" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>I/O Port Bit Number:</Label>
                <List>
                    <Option value="0">Bit 0</Option>
                    <Option value="1">Bit 1</Option>
                    <Option value="2">Bit 2</Option>
                    <Option value="3">Bit 3</Option>
                    <Option value="4">Bit 4</Option>
                    <Option value="5">Bit 5</Option>
                    <Option value="6">Bit 6</Option>
                    <Option value="7">Bit 7</Option>
                </List>
            </Field>

            <!-- ############     Digital Output ConfigUI      ############ -->
            <!-- ##############   3. Device Configuration    ############## -->

            <!-- digitalOutput ConfigUI configSeparator -->

            <Field id="zzConfigSeparator" type="separator"> </Field>
            <Field id="zzConfigTitle" type="label" alignText="center">
                <Label>Configure Digital Output</Label>
            </Field>

            <!-- digitalOutput ConfigUI momentary -->

            <Field id="momentary" type="checkbox" defaultValue="false">
                <Label>Momentary Turn-on:</Label>
            </Field>
            <Field id="turnOffDelay" type="textfield" defaultValue="0"
                   visibleBindingId="momentary" visibleBindingValue="true">
                <Label>Turn-off Delay (0-10 seconds):</Label>
            </Field>
            <Field id="zzDelayLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="momentary" visibleBindingValue="true">
                <Label>A turn-off delay of 0 seconds results in an actual delay of about 0.25 seconds.</Label>
            </Field>

            <!-- digitalOutput ConfigUI pwm -->

            <Field id="pwm" type="checkbox" defaultValue="false"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>Pulse Width Modulation (PWM):</Label>
            </Field>
            <Field id="frequency" type="textfield" defaultValue="100"
                   visibleBindingId="pwm" visibleBindingValue="true">
                <Label>PWM Frequency (1-8000 Hertz):</Label>
            </Field>
            <Field id="zzFrequencyLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="pwm" visibleBindingValue="true">
                <Label>The frequency actually used will be one of 16 discrete values that is closest to the frequency specified.  See the pigpio library documentation.</Label>
            </Field>
            <Field id="dutyCycle" type="textfield" defaultValue="50"
                   visibleBindingId="pwm" visibleBindingValue="true">
                <Label>PWM Duty Cycle (0-100 percent):</Label>
            </Field>

            <!-- digitalOutput ConfigUI bitRate -->

            <Field id="bitRate" type="textfield" defaultValue="10.0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI Bit Rate (0.1-10.0 Mb/s):</Label>
            </Field>
            <Field id="zzBitRateLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>Specify the SPI data transfer rate for this device.
                    The bit rate in Mb/s is equal to the SPI clock rate in MHz.</Label>
            </Field>

            <!-- digitalOutput ConfigUI checkSPI -->

            <Field id="checkSPI" type="checkbox" defaultValue="false"
                    visibleBindingId="ioDevType"
                    visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>Check SPI Integrity:</Label>
            </Field>
            <Field id="checkLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>Check SPI integrity by repeating each SPI device read.
                    Log a warning if the consecutive reads differ.
                    If this persists, the SPI bit rate may be too high for the device.</Label>
            </Field>

            <!-- ############     Digital Output ConfigUI      ############ -->
            <!-- ############      5. Polling and Logging      ############ -->

            <!-- digitalOutput ConfigUI pollingSeparator -->

            <Field id="zzPollingSeparator" type="separator"> </Field>
            <Field id="zzPollingTitle" type="label" alignText="center">
                <Label>Select Polling and Logging Options</Label>
            </Field>

            <!-- digitalOutput ConfigUI polling -->

            <Field id="polling" type="checkbox" defaultValue="false">
                <Label>Enable Output Polling:</Label>
            </Field>
            <Field id="zzPollingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center">
                <Label>Read the output state at regular intervals and log it if it has changed.</Label>
            </Field>
            <Field id="pollingInterval" type="textfield" defaultValue="0"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Polling Interval (seconds):</Label>
            </Field>
            <Field id="zzPollingIntervalLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                 <Label>Setting the interval to 0 reads the output state in each pass through the run loop.
                    The actual polling interval depends on the run loop time.</Label>
            </Field>

            <!-- digitalOutput ConfigUI logAll -->

            <Field id="logAll" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log All Polling Results:</Label>
            </Field>
            <Field id="zzLogAllLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log the output state after each poll regardless of change.
                    By default, only changed states are logged.</Label>
            </Field>

            <!-- digitalOutput ConfigUI monitorStatus -->

            <Field id="monitorStatus" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Monitor Polling Status:</Label>
            </Field>
            <Field id="zzMonitorStatusLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignText="center"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Compute and log the average polling interval and rate over the period of the status interval.</Label>
            </Field>
            <Field id="statusInterval" type="textfield" defaultValue="10.0"
                   visibleBindingId="monitorStatus" visibleBindingValue="true">
                <Label>Status Monitoring Interval (minutes):</Label>
            </Field>

        </ConfigUI>
    </Device>
</Devices>

