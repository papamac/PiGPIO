<?xml version="1.0"?>
<!--
 PACKAGE:  Raspberry Pi General Purpose Input/Output for Indigo
  MODULE:  Devices.xml
   TITLE:  Pi GPIO device definitions and ConfigUis (Devices.xml)
FUNCTION:  Devices.xml defines Pi GPIO device objects, specifies ConfigUis, and
           sets default values for device properties.
   USAGE:  Devices.xml is read and interpreted by the indigo server during
           plugin startup.  When a user creates a new device, indigo uses the
           xml data to instantiate device objects per the indigo object model
           (IOM).  The device object includes a pluginProps dictionary that
           contains the device properties from the xml fields.
  AUTHOR:  papamac
 VERSION:  0.7.0
    DATE:  February 14, 2023

DESCRIPTION:

This xml file contains ConfigUI descriptions for four devices: analogInput,
analogOutput, digitalInput, and digitalOutput.  Each ConfigUI is organized
into the following groups of fields and states:

1. Raspberry Pi Host
2. Device Type and Channel Id
3. Device Configuration
4. Processing
5. Polling and Logging
6. States

Many of the field id's are repeated in the four device ConfigUIs.  For ease in
locating the correct one, fields are commented with the device type and field
id.

CHANGE LOG:

Major changes to the Pi GPIO plugin are described in the CHANGES.md file in the
top level PiGPIO folder.  Changes of lesser importance may be described in
individual module docstrings if appropriate.

v0.5.0  11/28/2021  Fully functional beta version with minimal documentation.
v0.5.4    4/3/2022  Update the digitalInput relayInterrupts label field.
v0.5.8   9/11/2022  Add support for Docker Pi Relay devices and 8/10-bit dacs.
v0.5.9  10/12/2022  Add glitch filter option for built-in GPIO inputs.  Add a
                    "zz" prefix to all label, separator, and title id's so that
                    they sort at the end of a valuesDict print.  Change polling
                    options to logging options for analog and digital output
                    devices.
v0.7.0   2/14/2023  (1) Implement common sensor value processing for both
                    analog input and analog output devices.  Optionally enable
                    change detection, analog on/off thresholding, and limit
                    checking.
                    (2) Add display state selection for analog input and analog
                    output devices.
                    (3) Add turnOn/turnOff sensor values for analog output
                    devices.
                    (4) Change the device types for analog input and analog
                    output devices to custom.  Add/modify the following states:
                        sensorValue,
                        onOffState,
                        limitFault,
                        and limitFaultMessage.
-->


<Devices>


    <!-- ################################################################## -->
    <!-- #                                                                # -->
    <!-- #                      Analog Input Device                       # -->
    <!-- #                                                                # -->
    <!-- ################################################################## -->


    <Device id="analogInput" type="custom">
        <Name>Analog Input</Name>
        <ConfigUI>


            <!-- ############       Analog Input Device        ############ -->
            <!-- ############      1. Raspberry Pi Host        ############ -->


            <!-- analogInput hostTitle -->

            <Field id="zzHostTitle" type="label" alignText="center">
                <Label>Select Raspberry Pi Host</Label>
            </Field>


            <!-- analogInput hostAddress -->

            <Field id="hostAddress" type="textfield"
                   defaultValue="raspi4b-io.local">
                <Label>Host Address (FQDN or IPv4):</Label>
            </Field>


            <!-- analogInput portNumber -->

            <Field id="portNumber" type="textfield" defaultValue="8888">
                <Label>Port Number (1024-65535):</Label>
            </Field>


            <!-- analogInput hostId -->

            <Field id="hostId" type="textfield" defaultValue="">
                <Label>Host Id:</Label>
            </Field>

            <Field id="zzHostIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>The Host Id is a unique code used to identify the host in the indigo device address.  It may be user specified or left blank for automatic assignment. Automatically assigned id's are extracted from the host FQDN ("name-id.domainName"), or simply set to "pi".</Label>
            </Field>


            <!-- ############       Analog Input Device        ############ -->
            <!-- ############  2. Device Type and Channel Id   ############ -->


            <!-- analogInput selectionSeparator -->

            <Field id="zzSelectionSeparator" type="separator"> </Field>

            <Field id="zzSelectionTitle" type="label" alignText="center">
                <Label>Select ADC Device and Channel</Label>
            </Field>


            <!-- analogInput ioDevType -->

            <Field id="ioDevType" type="menu" defaultValue="MCP3208">
                <Label>ADC Device:</Label>
                <List>
                    <Option value="MCP3202">MCP3202 SPI 2-Channel 12-Bit ADC</Option>
                    <Option value="MCP3204">MCP3204 SPI 4-Channel 12-Bit ADC</Option>
                    <Option value="MCP3208">MCP3208 SPI 8-Channel 12-Bit ADC</Option>
                    <Option value="MCP3422">MCP3422 I2C 2-Channel 18-Bit ADC</Option>
                    <Option value="MCP3423">MCP3423 I2C 2-Channel 18-Bit ADC</Option>
                    <Option value="MCP3424">MCP3423 I2C 4-Channel 18-Bit ADC</Option>
                </List>
            </Field>


            <!-- analogInput spiChannel -->

            <Field id="spiChannel" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>SPI Channel:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>


            <!-- analogInput i2cAddress -->

            <Field id="i2cAddress" type="textfield"  hidden="true"> </Field>

            <Field id="i2cAddress8" type="menu" defaultValue="0x68"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3423, MCP3424)">
                <Label>I2C Address:</Label>
                <List>
                    <Option value="0x68">0x68</Option>
                    <Option value="0x69">0x69</Option>
                    <Option value="0x6a">0x6a</Option>
                    <Option value="0x6b">0x6b</Option>
                    <Option value="0x6c">0x6c</Option>
                    <Option value="0x6d">0x6d</Option>
                    <Option value="0x6e">0x6e</Option>
                    <Option value="0x6f">0x6f</Option>
                </List>
            </Field>


            <!-- analogInput adcChannel -->

            <Field id="adcChannel" type="textfield" hidden="true"> </Field>

            <Field id="adcChannel2" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3422, MCP3423)">
                <Label>ADC Channel Number:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>

            <Field id="adcChannel4" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3204, MCP3424)">
                <Label>ADC Channel Number:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                    <Option value="2">Channel 2</Option>
                    <Option value="3">Channel 3</Option>
                </List>
            </Field>

            <Field id="adcChannel8" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="MCP3208">
                <Label>ADC Channel Number:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                    <Option value="2">Channel 2</Option>
                    <Option value="3">Channel 3</Option>
                    <Option value="4">Channel 4</Option>
                    <Option value="5">Channel 5</Option>
                    <Option value="6">Channel 6</Option>
                    <Option value="7">Channel 7</Option>
                </List>
            </Field>


            <!-- ##############     Analog Input Device      ############## -->
            <!-- ##############   3. Device Configuration    ############## -->


            <!-- analogInput configSeparator -->

            <Field id="zzConfigSeparator" type="separator"> </Field>

            <Field id="zzConfigTitle" type="label" alignText="center">
                <Label>Configure ADC</Label>
            </Field>


            <!-- analogInput inputConfiguration -->

            <Field id="inputConfiguration" type="menu" defaultValue="1"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Input Configuration:</Label>
                <List>
                    <Option value="1">Single-ended</Option>
                    <Option value="0">Pseudo-differential</Option>
                </List>
            </Field>


            <!-- analogInput referenceVoltage -->

            <Field id="referenceVoltage" type="textfield" defaultValue="4.096"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Reference Voltage (V):</Label>
            </Field>

            <Field id="zzReferenceVoltageLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3202, MCP3204, MCP3208)">
                <Label>Enter the internal reference voltage for the selected ADC, or the external reference voltage if used..</Label>
            </Field>


            <!-- analogInput resolution -->

            <Field id="resolution" type="menu" defaultValue="12"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3422, MCP3423, MCP3424)">
                <Label>Resolution:</Label>
                <List>
                    <Option value="12">12 Bits</Option>
                    <Option value="14">14 Bits</Option>
                    <Option value="16">16 Bits</Option>
                    <Option value="18">18 Bits</Option>
                </List>
            </Field>


            <!-- analogInput gain -->

            <Field id="gain" type="menu" defaultValue="1"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3422, MCP3423, MCP3424)">
                <Label>PGA Gain:</Label>
                <List>
                    <Option value="1">1X Gain</Option>
                    <Option value="2">2X Gain</Option>
                    <Option value="4">4X Gain</Option>
                    <Option value="8">8X Gain</Option>
                </List>
            </Field>


            <!-- analogInput scalingFactor -->

            <Field id="scalingFactor" type="textfield" defaultValue="2.47058824">
                <Label>Scaling Factor:</Label>
            </Field>

            <Field id="zzScalingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>The Scaling Factor is used to calibrate an analog input device for a specific application.  It multiplies all raw values read from the ADC.  The default value is for voltage measurements using the AB Electronics ADC Pi board.</Label>
            </Field>


            <!-- analogInput units -->

            <Field id="units" type="menu" defaultValue=" ">
                <Label>Sensor Value Units:</Label>
                <List>
                    <Option value=" ">None</Option>
                    <Option value="V">Volts (V)</Option>
                    <Option value="mV">Milivolts (mV)</Option>
                    <Option value="µV">Microvolts (µV)</Option>
                    <Option value="A">Amperes (A)</Option>
                    <Option value="mA">Miliamps (mA)</Option>
                    <Option value="µA">Microamps (µA)</Option>
                    <Option value="W">Watts (W)</Option>
                    <Option value="mW">Miliwatts (mW)</Option>
                    <Option value="µW">Microwatts (µW)</Option>
                    <Option value="°F">Degrees Fahrenheit (°F)</Option>
                    <Option value="°C">Degrees Celsius (°C)</Option>
                </List>
            </Field>

            <!-- analogInput bitRate -->

            <Field id="bitRate" type="textfield" defaultValue="2000"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP3204, MCP3208)">
                <Label>SPI Bit Rate (100-10000 kb/s):</Label>
            </Field>

            <Field id="zzBitRateLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>SPI bus data transfer rate for this device.  The bit rate in kb/s is usually equal to the SPI clock rate in kHz.</Label>
            </Field>


            <!-- ##############     Analog Input Device      ############## -->
            <!-- ##############        4. Processing         ############## -->


            <!-- analogOutput processingSeparator -->

            <Field id="zzProcessingSeparator" type="separator"> </Field>

            <Field id="zzProcessingTitle" type="label" alignText="center">
                <Label>Select Display and Processing Options</Label>
            </Field>

            <!-- analogInput displayStateId -->

            <Field id="displayStateId" type="menu" defaultValue="sensorValue">
                <Label>Display State:</Label>
                <List>
                    <Option value="sensorValue">Sensor Value</Option>
                    <Option value="onOffState">On/Off State</Option>
                </List>
            </Field>

            <Field id="zzDisplayStateIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Select the state to display in the Indigo Home window.</Label>
            </Field>


            <!-- analogInput changeThreshold -->

            <Field id="changeThreshold" type="textfield" defaultValue="None">
                <Label>Change Detection Threshold (percent or None):</Label>
            </Field>

            <Field id="zzChangeThresholdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter a percentage threshold for change detection or None if no change detection is desired.</Label>
            </Field>

            <!-- analogInput onThreshold -->

            <Field id="onThreshold" type="textfield" defaultValue="None">
                <Label>Analog On Threshold (units or None):</Label>
            </Field>

            <Field id="zzOnThresholdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter an analog on threshold for the onOffState or None if no onOffState is desired.</Label>
            </Field>


            <!-- analogInput lowLimit -->

            <Field id="lowLimit" type="textfield" defaultValue="None">
                <Label>Low Limit (units or None):</Label>
            </Field>

            <Field id="zzLowLimitLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter a low limit for limit checking or None if no low limit checking is desired.</Label>
            </Field>


             <!-- analogInput highLimit -->

            <Field id="highLimit" type="textfield" defaultValue="None">
                <Label>High Limit (units or None):</Label>
            </Field>

            <Field id="zzHighLimitLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter a high limit for limit checking or None if no high limit checking is desired.</Label>
            </Field>


            <!-- ############       Analog Input Device        ############ -->
            <!-- ############      5. Polling and Logging      ############ -->


            <!-- analogInput pollingSeparator -->

            <Field id="zzPollingSeparator" type="separator"> </Field>

            <Field id="zzPollingTitle" type="label" alignText="center">
                <Label>Select Polling and Logging Options</Label>
            </Field>


            <!-- analogInput polling -->

            <Field id="polling" type="checkbox" defaultValue="false">
                <Label>Enable Input Polling:</Label>
            </Field>

            <Field id="zzPollingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Read the sensor value at regular intervals, perform change detection and limit checks, update the value, and log it if changed.</Label>
            </Field>

            <Field id="pollingInterval" type="textfield" defaultValue="10"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Polling Interval (seconds):</Label>
            </Field>

            <Field id="zzPollingIntervalLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Setting the interval to 0 reads the output in each pass through the run loop.  The actual polling interval depends on the run loop time.</Label>
            </Field>


            <!-- analogInput logAll -->

            <Field id="logAll" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log All Polling Results:</Label>
            </Field>

            <Field id="zzLogAllLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log the sensor value after each poll regardless of the change.  By default, only changed values are logged.</Label>
            </Field>


        </ConfigUI>


        <States>


            <!-- ############       Analog Input Device        ############ -->
            <!-- ############             6. States            ############ -->


            <!-- analogInput sensorValue -->

            <State id="sensorValue">
                <ValueType>Number</ValueType>
                <TriggerLabel>Sensor Value Change Detected</TriggerLabel>
				<ControlPageLabel>Sensor Value Change Detected</ControlPageLabel>
            </State>


            <!-- analogInput onOffState -->

            <State id="onOffState">
				<ValueType boolType="OnOff">Boolean</ValueType>
				<TriggerLabel>OnOff State</TriggerLabel>
				<ControlPageLabel>OnOff State</ControlPageLabel>
			</State>


            <!-- analogInput changeDetected -->

            <State id="changeDetected">
                <ValueType boolType="TrueFalse">Boolean</ValueType>
                <TriggerLabel>Sensor Value Change Detected</TriggerLabel>
				<ControlPageLabel>Sensor Value Change Detected</ControlPageLabel>
            </State>


            <!-- analogInput limitFault -->

            <State id="limitFault">
                <ValueType boolType="TrueFalse">Boolean</ValueType>
                <TriggerLabel>Sensor Value Limit Fault</TriggerLabel>
				<ControlPageLabel>Sensor Value Limit Fault</ControlPageLabel>
            </State>


            <!-- analogInput limitFaultMessage -->

            <State id="limitFaultMessage">
                <ValueType>String</ValueType>
                <TriggerLabel>Last Limit Fault Message</TriggerLabel>
				<ControlPageLabel>Last Limit Fault Message</ControlPageLabel>
            </State>


        </States>


    </Device>


    <!-- ################################################################## -->
    <!-- #                                                                # -->
    <!-- #                     Analog Output Device                       # -->
    <!-- #                                                                # -->
    <!-- ################################################################## -->


    <Device id="analogOutput" type="custom">
        <Name>Analog Output</Name>
        <ConfigUI>


            <!-- ############       Analog Output Device       ############ -->
            <!-- ############       1. Raspberry Pi Host       ############ -->


            <!-- analogOutput hostTitle -->

            <Field id="zzHostTitle" type="label" alignText="center">
                <Label>Select Raspberry Pi Host</Label>
            </Field>


            <!-- analogOutput hostAddress -->

            <Field id="hostAddress" type="textfield"
                   defaultValue="raspi4b-io.local">
                <Label>Host Address (FQDN or IPv4):</Label>
            </Field>


            <!-- analogOutput portNumber -->

            <Field id="portNumber" type="textfield" defaultValue="8888">
                <Label>Port Number (1024-65535):</Label>
            </Field>


            <!-- analogOutput hostId -->

            <Field id="hostId" type="textfield" defaultValue="">
                <Label>Host Id:</Label>
            </Field>

            <Field id="zzHostIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>The Host Id is a unique code used to identify the host in the indigo device address.  It may be user specified or left blank for automatic assignment. Automatically assigned id's are extracted from the host FQDN ("name-id.domainName"), or simply set to "pi".</Label>
            </Field>


            <!-- ############      Analog Output Device        ############ -->
            <!-- ############  2. Device Type and Channel Id   ############ -->


            <!-- analogOutput selectionSeparator -->

            <Field id="zzSelectionSeparator" type="separator"> </Field>

            <Field id="zzSelectionTitle" type="label" alignText="center">
                <Label>Select DAC Device and Channel</Label>
            </Field>


            <!-- analogOutput ioDevType -->

            <Field id="ioDevType" type="menu" defaultValue="MCP4822">
                <Label>DAC Device:</Label>
                <List>
                    <Option value="MCP4801">MCP4801 SPI Single Channel 8-Bit DAC</Option>
                    <Option value="MCP4802">MCP4802 SPI Dual Channel 8-Bit DAC</Option>
                    <Option value="MCP4811">MCP4811 SPI Single Channel 10-Bit DAC</Option>
                    <Option value="MCP4812">MCP4812 SPI Dual Channel 10-Bit DAC</Option>
                    <Option value="MCP4821">MCP4821 SPI Single Channel 12-Bit DAC</Option>
                    <Option value="MCP4822">MCP4822 SPI Dual Channel 12-Bit DAC</Option>
                </List>
            </Field>


            <!-- analogOutput spiChannel -->

            <Field id="spiChannel" type="menu" defaultValue="0">
                <Label>SPI Channel:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>


             <!-- analogOutput dacChannel -->

            <Field id="dacChannel" type="textfield" hidden="true"> </Field>

            <Field id="dacChannel1" type="textfield" defaultValue="0"
                   hidden="true"
                   visibleBindingId="ioDevType" visibleBindingValue="(MCP4801, MCP4811, MCP4821)">
            </Field>

            <Field id="dacChannel2" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType" visibleBindingValue="(MCP4802, MCP4812, MCP4822)">
                <Label>DAC Channel:</Label>
                <List>
                    <Option value="0">Channel 0 (Output A)</Option>
                    <Option value="1">Channel 1 (Output B)</Option>
                </List>
            </Field>


            <!-- ##############    Analog Output Device      ############## -->
            <!-- ##############   3. Device Configuration    ############## -->


            <!-- analogOutput configSeparator -->

            <Field id="zzConfigSeparator" type="separator"> </Field>

            <Field id="zzConfigTitle" type="label" alignText="center">
                <Label>Configure DAC</Label>
            </Field>


            <!-- analogOutput gain -->

            <Field id="gain" type="menu" defaultValue="1">
                <Label>Gain:</Label>
                <List>
                    <Option value="1">1X Gain - output range of 0-2.048 V</Option>
                    <Option value="2">2X Gain - output range of 0-4.096 V</Option>
                </List>
            </Field>


            <!-- analogOutput scalingFactor -->

            <Field id="scalingFactor" type="textfield" defaultValue="1.0">
                <Label>Scaling Factor:</Label>
            </Field>

            <Field id="zzScalingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>The Scaling Factor is used to calibrate an analog output device for a specific application.  It divides all sensor values written to the DAC.</Label>
            </Field>


            <!-- analogOutput units -->

            <Field id="units" type="menu" defaultValue=" ">
                <Label>Sensor Value Units:</Label>
                <List>
                    <Option value=" ">None</Option>
                    <Option value="V">Volts (V)</Option>
                    <Option value="mV">Milivolts (mV)</Option>
                    <Option value="µV">Microvolts (µV)</Option>
                    <Option value="A">Amperes (A)</Option>
                    <Option value="mA">Miliamps (mA)</Option>
                    <Option value="µA">Microamps (µA)</Option>
                    <Option value="W">Watts (W)</Option>
                    <Option value="mW">Miliwatts (mW)</Option>
                    <Option value="µW">Microwatts (µW)</Option>
                    <Option value="°F">Degrees Fahrenheit (°F)</Option>
                    <Option value="°C">Degrees Celsius (°C)</Option>
                </List>
            </Field>


            <!-- analogOutput bitRate -->

            <Field id="bitRate" type="textfield" defaultValue="2000">
                <Label>SPI Bit Rate (100-10000 kb/s):</Label>
            </Field>

            <Field id="zzBitRateLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>SPI bus data transfer rate for this device.  The bit rate in kb/s is usually equal to the SPI clock rate in kHz.</Label>
            </Field>


            <!-- ##############     Analog Output Device     ############## -->
            <!-- ##############        4. Processing         ############## -->


            <!-- analogOutput processingSeparator -->

            <Field id="zzProcessingSeparator" type="separator"> </Field>

            <Field id="zzProcessingTitle" type="label" alignText="center">
                <Label>Select Display and Processing Options</Label>
            </Field>


            <!-- analogOutput displayStateId -->

            <Field id="displayStateId" type="menu" defaultValue="sensorValue">
                <Label>Display State:</Label>
                <List>
                    <Option value="sensorValue">Sensor Value</Option>
                    <Option value="onOffState">On/Off State</Option>
                </List>
            </Field>

            <Field id="zzDisplayStateIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Select the state to display in the Indigo Home window.</Label>
            </Field>


            <!-- analogOutput changeThreshold -->

            <Field id="changeThreshold" type="textfield" defaultValue="None">
                <Label>Change Detection Threshold (percent or None):</Label>
            </Field>

            <Field id="zzChangeThresholdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter a percentage threshold for change detection or None if no change detection is desired.</Label>
            </Field>


            <!-- analogOutput onThreshold -->

            <Field id="onThreshold" type="textfield" defaultValue="None">
                <Label>Analog On Threshold (units or None):</Label>
            </Field>

            <Field id="zzOnThresholdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter an analog on threshold for the onOffState or None if no onOffState is desired.</Label>
            </Field>


            <!-- analogOutput lowLimit -->

            <Field id="lowLimit" type="textfield" defaultValue="None">
                <Label>Low Limit (units or None):</Label>
            </Field>

            <Field id="zzLowLimitLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter a low limit for limit checking or None if no low limit checking is desired.</Label>
            </Field>


             <!-- analogOutput highLimit -->

            <Field id="highLimit" type="textfield" defaultValue="None">
                <Label>High Limit (units or None):</Label>
            </Field>

            <Field id="zzHighLimitLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter a high limit for limit checking or None if no high limit checking is desired.</Label>
            </Field>


            <!-- analogOutput turnOnValue -->

            <Field id="turnOnValue" type="textfield" defaultValue="None">
                <Label>Turn On Sensor Value (units or None):</Label>
            </Field>

            <Field id="zzTurnOnValueLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter a sensor value to write in a turn on action, or None if no turn on is desired.</Label>
            </Field>


             <!-- analogOutput turnOffValue -->

            <Field id="turnOffValue" type="textfield" defaultValue="None">
                <Label>Turn Off Sensor Value (units or None):</Label>
            </Field>

            <Field id="zzTurnOffValueLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Enter a sensor value to write in a turn off action, or None if no turn off is desired.</Label>
            </Field>


            <!-- ############       Analog Output Device       ############ -->
            <!-- ############      5. Polling and Logging      ############ -->


            <!-- analogOutput loggingSeparator -->

            <Field id="zzLoggingSeparator" type="separator"> </Field>

            <Field id="zzLoggingTitle" type="label" alignText="center">
                <Label>Select Logging Options</Label>
            </Field>


            <!-- analogOutput polling -->

            <Field id="polling" type="checkbox" defaultValue="false">
                <Label>Enable Output Logging:</Label>
            </Field>

            <Field id="zzPollingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Log the output value at regular intervals.</Label>
            </Field>

            <Field id="pollingInterval" type="textfield" defaultValue="10"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Logging Interval (seconds):</Label>
            </Field>

            <Field id="zzPollingIntervalLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Setting the interval to 0 logs the output in each pass through the run loop.  The actual logging interval depends on the run loop time.</Label>
            </Field>


            <!-- analogOutput logAll -->

            <Field id="logAll" type="checkbox" defaultValue="true"
                   hidden="true"> </Field>


        </ConfigUI>


        <States>


            <!-- ############       Analog Output Device       ############ -->
            <!-- ############             6. States            ############ -->


            <!-- analogOutput sensorValue -->

            <State id="sensorValue">
                <ValueType>Number</ValueType>
                <TriggerLabel>Sensor Value Change Detected</TriggerLabel>
				<ControlPageLabel>Sensor Value Change Detected</ControlPageLabel>
            </State>


            <!-- analogOutput onOffState -->

            <State id="onOffState">
				<ValueType boolType="OnOff">Boolean</ValueType>
				<TriggerLabel>OnOff State</TriggerLabel>
				<ControlPageLabel>OnOff State</ControlPageLabel>
			</State>


            <!-- analogOutput changeDetected -->

            <State id="changeDetected">
                <ValueType boolType="TrueFalse">Boolean</ValueType>
                <TriggerLabel>Sensor Value Change Detected</TriggerLabel>
				<ControlPageLabel>Sensor Value Change Detected</ControlPageLabel>
            </State>


            <!-- analogOutput limitFault -->

            <State id="limitFault">
                <ValueType boolType="TrueFalse">Boolean</ValueType>
                <TriggerLabel>Sensor Value Limit Fault</TriggerLabel>
				<ControlPageLabel>Sensor Value Limit Fault</ControlPageLabel>
            </State>


            <!-- analogOutput limitFaultMessage -->

            <State id="limitFaultMessage">
                <ValueType>String</ValueType>
                <TriggerLabel>Last Limit Fault Message</TriggerLabel>
				<ControlPageLabel>Last Limit Fault Message</ControlPageLabel>
            </State>


        </States>


    </Device>


    <!-- ################################################################## -->
    <!-- #                                                                # -->
    <!-- #                     Digital Input Device                       # -->
    <!-- #                                                                # -->
    <!-- ################################################################## -->


    <Device id="digitalInput" type="sensor">
        <Name>Digital Input</Name>
        <ConfigUI>


            <!-- ############       Digital Input Device       ############ -->
            <!-- ############       1. Raspberry Pi Host       ############ -->


            <!-- digitalInput hostTitle-->

            <Field id="zzHostTitle" type="label" alignText="center">
                <Label>Select Raspberry Pi Host</Label>
            </Field>


            <!-- digitalInput hostAddress -->

            <Field id="hostAddress" type="textfield"
                   defaultValue="raspi4b-io.local">
                <Label>Host Address (FQDN or IPv4):</Label>
            </Field>


            <!-- digitalInput portNumber -->

            <Field id="portNumber" type="textfield" defaultValue="8888">
                <Label>Port Number (1024-65535):</Label>
            </Field>


            <!-- digitalInput hostId -->

            <Field id="hostId" type="textfield" defaultValue="">
                <Label>Host Id:</Label>
            </Field>

            <Field id="zzHostIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>The Host Id is a unique code used to identify the host in the indigo device address.  It may be user specified or left blank for automatic assignment. Automatically assigned id's are extracted from the host FQDN ("name-id.domainName"), or simply set to "pi".</Label>
            </Field>


            <!-- ############      Digital Input Device        ############ -->
            <!-- ############  2. Device Type and Channel Id   ############ -->


            <!-- digitalInput selectionSeparator -->

            <Field id="zzSelectionSeparator" type="separator"> </Field>

            <Field id="zzSelectionTitle" type="label" alignText="center">
                <Label>Select Digital Input Device and GPIO Bit</Label>
            </Field>


            <!-- digitalInput ioDevType -->

            <Field id="ioDevType" type="menu" defaultValue="pigpio">
                <Label>Digital Input Device:</Label>
                <List>
                    <Option value="pigpio">Built-in Raspberry Pi GPIO</Option>
                    <Option value="MCP23008">MCP23008 I2C 8-Bit I/O Expander</Option>
                    <Option value="MCP23017">MCP23017 I2C 16-Bit I/O Expander</Option>
                    <Option value="MCP23S08">MCP23S08 SPI 8-Bit I/O Expander</Option>
                    <Option value="MCP23S17">MCP23S17 SPI 16-Bit I/O Expander</Option>
                </List>
            </Field>


            <!-- digitalInput gpioNumber -->

            <Field id="gpioNumber" type="menu" defaultValue="17"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>BCM GPIO Number:</Label>
                <List>
                    <Option value="4">GPIO 4</Option>
                    <Option value="5">GPIO 5</Option>
                    <Option value="6">GPIO 6</Option>
                    <Option value="12">GPIO 12</Option>
                    <Option value="13">GPIO 13</Option>
                    <Option value="16">GPIO 16</Option>
                    <Option value="17">GPIO 17</Option>
                    <Option value="18">GPIO 18</Option>
                    <Option value="19">GPIO 19</Option>
                    <Option value="20">GPIO 20</Option>
                    <Option value="21">GPIO 21</Option>
                    <Option value="22">GPIO 22</Option>
                    <Option value="23">GPIO 23</Option>
                    <Option value="24">GPIO 24</Option>
                    <Option value="25">GPIO 25</Option>
                    <Option value="26">GPIO 26</Option>
                    <Option value="27">GPIO 27</Option>
                </List>
            </Field>


            <!-- digitalInput i2cAddress -->

            <Field id="i2cAddress" type="textfield"  hidden="true"> </Field>

            <Field id="i2cAddress8" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017)">
                <Label>I2C Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                    <Option value="0x24">0x24</Option>
                    <Option value="0x25">0x25</Option>
                    <Option value="0x26">0x26</Option>
                    <Option value="0x27">0x27</Option>
                </List>
            </Field>


            <!-- digitalInput spiChannel -->

            <Field id="spiChannel" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI Channel:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>


            <!-- digitalInput spiDeviceAddress -->

            <Field id="spiDevAddress" type="textfield" defaultValue="0x20"
                   hidden="true"> </Field>

            <Field id="spiDevAddress4" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType" visibleBindingValue="MCP23S08">
                <Label>SPI Device Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                </List>
            </Field>

            <Field id="spiDevAddress8" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType" visibleBindingValue="MCP23S17">
                <Label>SPI Device Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                    <Option value="0x24">0x24</Option>
                    <Option value="0x25">0x25</Option>
                    <Option value="0x26">0x26</Option>
                    <Option value="0x27">0x27</Option>
                </List>
            </Field>


            <!-- digitalInput ioPort -->

            <Field id="ioPort" type="menu" defaultValue="a"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23017, MCP23S17)">
                <Label>16-Bit I/O Expander Port:</Label>
                <List>
                    <Option value="a">Port A</Option>
                    <Option value="b">Port B</Option>
                </List>
            </Field>


            <!-- digitalInput bitNumber -->

            <Field id="bitNumber" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>I/O Port Bit Number:</Label>
                <List>
                    <Option value="0">Bit 0</Option>
                    <Option value="1">Bit 1</Option>
                    <Option value="2">Bit 2</Option>
                    <Option value="3">Bit 3</Option>
                    <Option value="4">Bit 4</Option>
                    <Option value="5">Bit 5</Option>
                    <Option value="6">Bit 6</Option>
                    <Option value="7">Bit 7</Option>
                </List>
            </Field>


            <!-- ##############     Digital Input Device     ############## -->
            <!-- ##############   3. Device Configuration    ############## -->


             <!-- digitalInput configSeparator -->

            <Field id="zzConfigSeparator" type="separator"> </Field>

            <Field id="zzConfigTitle" type="label" alignText="center">
                <Label>Configure Digital Input</Label>
            </Field>


            <!-- digitalInput invert -->

            <Field id="invert" type="checkbox" defaultValue="false">
                <Label>Invert On/Off State:</Label>
            </Field>

            <Field id="zzInvertLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>If checked, the on/off state is set to on for logic low and to off for logic high.</Label>
            </Field>


            <!-- digitalInput pullup -->

            <Field id="pullup" type="textfield" defaultValue="off"
                   hidden="true"> </Field>

            <Field id="pullup1" type="menu" defaultValue="off"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>Internal Input Bias:</Label>
                <List>
                    <Option value="off">Open (no bias)</Option>
                    <Option value="up">Pull up to logic high</Option>
                    <Option value="down">Pull down to logic low</Option>
                </List>
            </Field>

            <Field id="zzPullup1Label" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>Open applies no bias to the digital input. Pull up or down biases the input to logic high or low through an internal resistor.</Label>
            </Field>

            <Field id="pullup2" type="menu" defaultValue="off"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>Internal Input Bias:</Label>
                <List>
                    <Option value="off">Open (no bias)</Option>
                    <Option value="up">Pull up to logic high</Option>
                </List>
            </Field>

            <Field id="zzPullup2Label" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>Open applies no bias to the digital input. Pull up biases the input to logic high through an internal resistor.</Label>
            </Field>

            <!-- digitalInput bitRate -->

            <Field id="bitRate" type="textfield" defaultValue="2000"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI Bit Rate (100-10000 kb/s):</Label>
            </Field>

            <Field id="zzBitRateLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI bus data transfer rate for this device.  The bit rate in kb/s is usually equal to the SPI clock rate in kHz.</Label>
            </Field>


            <!-- ##############     Digital Input Device     ############## -->
            <!-- ##############        4. Processing         ############## -->


             <!-- digitalInput interruptSeparator -->

            <Field id="zzInterruptSeparator" type="separator"> </Field>

            <Field id="zzInterruptTitle" type="label" alignText="center">
                <Label>Select Interrupt and Filter Options</Label>
            </Field>


            <!-- digitalInput callback -->

            <Field id="callback" type="checkbox" defaultValue="false"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>Use GPIO Callback:</Label>
            </Field>

            <Field id="zzCallbackLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>The GPIO callback updates/logs the device state on an input state change.  It eliminates the need for polling to detect changes.  It also enables interrupt relay and debounce filtering if requested.</Label>
            </Field>


            <!-- digitalInput glitchFilter -->

            <Field id="glitchFilter" type="checkbox" defaultValue="false"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>Enable Glitch Filter:</Label>
            </Field>

            <Field id="zzGlitchFilterLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>The glitch filter rejects callback state changes that are not stable for longer than the glitch time.  The callback is delayed by the glitch time.</Label>
            </Field>

            <Field id="glitchTime" type="textfield" defaultValue="10"
                   visibleBindingId="glitchFilter" visibleBindingValue="true">
                <Label>Glitch Time (µsec):</Label>
            </Field>

            <Field id="zzGlitchTimeLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="glitchFilter" visibleBindingValue="true">
                <Label>The glitch time should be as short as possible, but long enough to eliminate short, spurious glitches.</Label>
            </Field>


            <!-- digitalInput bounceFilter -->

            <Field id="bounceFilter" type="checkbox" defaultValue="false"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>Enable Contact Bounce Filter:</Label>
            </Field>

            <Field id="zzBounceFilterLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>The bounce filter rejects callback state changes that are separated by less than the bounce time.  It is used to eliminate multiple responses from bouncing mechanical switches/relays.</Label>
            </Field>

            <Field id="bounceTime" type="textfield" defaultValue="100"
                   visibleBindingId="bounceFilter" visibleBindingValue="true">
                <Label>Bounce Time (µsec):</Label>
            </Field>

            <Field id="zzBounceTimeLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="bounceFilter" visibleBindingValue="true">
                <Label>The bounce time must be tuned to each switch/application.  If too low, bouncing states will be processed normally.  If too high, valid state changes could be rejected.</Label>
            </Field>

            <Field id="logBounce" type="checkbox" defaultValue="false"
                   visibleBindingId="bounceFilter" visibleBindingValue="true">
                <Label>Log Bounce Filter Warnings:</Label>
            </Field>


            <!-- digitalInput relayInterrupts -->

            <Field id="relayInterrupts" type="checkbox" defaultValue="false"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>Relay Hardware Interrupts:</Label>
            </Field>

            <Field id="zzRelayInterruptsLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="callback" visibleBindingValue="true">
                <Label>Indicates that this GPIO input is connected to hardware interrupt outputs from one or more interrupt devices.  A transition on this GPIO causes the callback method to relay the interrupt to all interrupt devices.</Label>
            </Field>


            <!-- digitalInput hardwareInterrupt -->

            <Field id="hardwareInterrupt" type="checkbox" defaultValue="false"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>Enable Hardware Interrupt:</Label>
            </Field>

            <Field id="zzHardwareInterruptLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="hardwareInterrupt"
                   visibleBindingValue="true">
                <Label>Enabling hardware interrupt raises a hardware interrupt output on an input state change.  The interrupt output must be connected to a GPIO input that is configured for callback and interrupt relay.</Label>
            </Field>

            <Field id="interruptRelayGPIO" type="menu"
                   visibleBindingId="hardwareInterrupt"
                   visibleBindingValue="true">
                <Label>Select Interrupt Relay GPIO:</Label>
                <List class="self" method="getGPIORelayDevices"
                      dynamicReload="yes"/>
            </Field>


            <!-- ############       Digital Input Device       ############ -->
            <!-- ############      5. Polling and Logging      ############ -->


            <!-- digitalInput pollingSeparator -->

            <Field id="zzPollingSeparator" type="separator"> </Field>

            <Field id="zzPollingTitle" type="label" alignText="center">
                <Label>Select Polling and Logging Options</Label>
            </Field>


            <!-- digitalInput polling -->

            <Field id="polling" type="checkbox" defaultValue="false">
                <Label>Enable Input Polling:</Label>
            </Field>

            <Field id="zzPollingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Read the input state at regular intervals and logs it if it has changed.</Label>
            </Field>

            <Field id="pollingInterval" type="textfield" defaultValue="0"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Polling Interval (seconds):</Label>
            </Field>

            <Field id="zzPollingIntervalLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Setting the interval to 0 reads the input state in each pass through the run loop.  The actual polling interval depends on the run loop time.</Label>
            </Field>


            <!-- digitalInput logAll -->

            <Field id="logAll" type="checkbox" defaultValue="false"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log All Polling Results:</Label>
            </Field>

            <Field id="zzLogAllLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Log the input state after each poll regardless of change.  By default, only changed states are logged.</Label>
            </Field>


        </ConfigUI>


    </Device>


    <!-- ################################################################## -->
    <!-- #                                                                # -->
    <!-- #                     Digital Output Device                      # -->
    <!-- #                                                                # -->
    <!-- ################################################################## -->


    <Device id="digitalOutput" type="relay">
        <Name>Digital Output</Name>
        <ConfigUI>


            <!-- ############       Digital Output Device      ############ -->
            <!-- ############       1. Raspberry Pi Host       ############ -->


            <!-- digitalOutput hostTitle -->

            <Field id="zzHostTitle" type="label" alignText="center">
                <Label>Select Raspberry Pi Host</Label>
            </Field>


             <!-- digitalOutput hostAddress -->

            <Field id="hostAddress" type="textfield"
                   defaultValue="raspi4b-io.local">
                <Label>Host Address (FQDN or IPv4):</Label>
            </Field>


            <!-- digitalOutput portNumber -->

            <Field id="portNumber" type="textfield" defaultValue="8888">
                <Label>Port Number (1024-65535):</Label>
            </Field>


             <!-- digitalOutput hostId -->

            <Field id="hostId" type="textfield" defaultValue="">
                <Label>Host Id:</Label>
            </Field>

            <Field id="zzHostIdLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>The Host Id is a unique code used to identify the host in the indigo device address.  It may be user specified or left blank for automatic assignment. Automatically assigned id's are extracted from the host FQDN ("name-id.domainName"), or simply set to "pi".</Label>
            </Field>


            <!-- ############      Digital Output Device       ############ -->
            <!-- ############  2. Device Type and Channel Id   ############ -->


             <!-- digitalOutput selectionSeparator -->

            <Field id="zzSelectionSeparator" type="separator"> </Field>

            <Field id="zzSelectionTitle" type="label" alignText="center">
                <Label>Select Digital Output Device and GPIO Bit / Relay</Label>
            </Field>


             <!-- digitalOutput ioDevType -->

            <Field id="ioDevType" type="menu" defaultValue="pigpio">
                <Label>Digital Output Device:</Label>
                <List>
                    <Option value="pigpio">Built-in Raspberry Pi GPIO</Option>
                    <Option value="dkrPiRly">I2C Docker Pi Relay</Option>
                    <Option value="MCP23008">MCP23008 I2C 8-Bit I/O Expander</Option>
                    <Option value="MCP23017">MCP23017 I2C 16-Bit I/O Expander</Option>
                    <Option value="MCP23S08">MCP23S08 SPI 8-Bit I/O Expander</Option>
                    <Option value="MCP23S17">MCP23S17 SPI 16-Bit I/O Expander</Option>
                </List>
            </Field>


             <!-- digitalOutput gpioNumber -->

            <Field id="gpioNumber" type="menu" defaultValue="17"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>BCM GPIO Number:</Label>
                <List>
                    <Option value="4">GPIO 4</Option>
                    <Option value="5">GPIO 5</Option>
                    <Option value="6">GPIO 6</Option>
                    <Option value="12">GPIO 12</Option>
                    <Option value="13">GPIO 13</Option>
                    <Option value="16">GPIO 16</Option>
                    <Option value="17">GPIO 17</Option>
                    <Option value="18">GPIO 18</Option>
                    <Option value="19">GPIO 19</Option>
                    <Option value="20">GPIO 20</Option>
                    <Option value="21">GPIO 21</Option>
                    <Option value="22">GPIO 22</Option>
                    <Option value="23">GPIO 23</Option>
                    <Option value="24">GPIO 24</Option>
                    <Option value="25">GPIO 25</Option>
                    <Option value="26">GPIO 26</Option>
                    <Option value="27">GPIO 27</Option>
                </List>
            </Field>


            <!-- digitalOutput i2cAddress -->

            <Field id="i2cAddress" type="textfield"  hidden="true"> </Field>

            <Field id="i2cAddress4" type="menu" defaultValue="0x10"
                   visibleBindingId="ioDevType" visibleBindingValue="dkrPiRly">
                <Label>I2C Address:</Label>
                <List>
                    <Option value="0x10">0x10</Option>
                    <Option value="0x11">0x11</Option>
                    <Option value="0x12">0x12</Option>
                    <Option value="0x13">0x13</Option>
                </List>
            </Field>

            <Field id="i2cAddress8" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017)">
                <Label>I2C Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                    <Option value="0x24">0x24</Option>
                    <Option value="0x25">0x25</Option>
                    <Option value="0x26">0x26</Option>
                    <Option value="0x27">0x27</Option>
                </List>
            </Field>


            <!--  digitalOutput relayNumber  -->

            <Field id="relayNumber" type="menu" defaultValue="1"
                   visibleBindingId="ioDevType" visibleBindingValue="dkrPiRly">
                <Label>Relay Number:</Label>
                <List>
                    <Option value="1">Relay 1</Option>
                    <Option value="2">Relay 2</Option>
                    <Option value="3">Relay 3</Option>
                    <Option value="4">Relay 4</Option>
                </List>
            </Field>


            <!-- digitalOutput spiChannel -->

            <Field id="spiChannel" type="menu" visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI Channel:</Label>
                <List>
                    <Option value="0">Channel 0</Option>
                    <Option value="1">Channel 1</Option>
                </List>
            </Field>


            <!-- digitalOutput spiDevAddress -->

            <Field id="spiDevAddress" type="textfield" hidden="true"> </Field>

            <Field id="spiDevAddress4" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType" visibleBindingValue="MCP23S08">
                <Label>SPI Device Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                </List>
            </Field>

            <Field id="spiDevAddress8" type="menu" defaultValue="0x20"
                   visibleBindingId="ioDevType" visibleBindingValue="MCP23S17">
                <Label>SPI Device Address:</Label>
                <List>
                    <Option value="0x20">0x20</Option>
                    <Option value="0x21">0x21</Option>
                    <Option value="0x22">0x22</Option>
                    <Option value="0x23">0x23</Option>
                    <Option value="0x24">0x24</Option>
                    <Option value="0x25">0x25</Option>
                    <Option value="0x26">0x26</Option>
                    <Option value="0x27">0x27</Option>
                </List>
            </Field>


            <!-- digitalOutput ioPort -->

            <Field id="ioPort" type="menu" defaultValue="a"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23017, MCP23S17)">
                <Label>16-Bit I/O Expander Port:</Label>
                <List>
                    <Option value="a">Port A</Option>
                    <Option value="b">Port B</Option>
                </List>
            </Field>


            <!-- digitalOutput bitNumber -->

            <Field id="bitNumber" type="menu" defaultValue="0"
                   visibleBindingId="ioDevType"
                   visibleBindingValue="(MCP23008, MCP23017, MCP23S08, MCP23S17)">
                <Label>I/O Port Bit Number:</Label>
                <List>
                    <Option value="0">Bit 0</Option>
                    <Option value="1">Bit 1</Option>
                    <Option value="2">Bit 2</Option>
                    <Option value="3">Bit 3</Option>
                    <Option value="4">Bit 4</Option>
                    <Option value="5">Bit 5</Option>
                    <Option value="6">Bit 6</Option>
                    <Option value="7">Bit 7</Option>
                </List>
            </Field>


            <!-- ##############     Digital Output Device    ############## -->
            <!-- ##############   3. Device Configuration    ############## -->


            <!-- digitalOutput configSeparator -->

            <Field id="zzConfigSeparator" type="separator"> </Field>

            <Field id="zzConfigTitle" type="label" alignText="center">
                <Label>Configure Digital Output</Label>
            </Field>


            <!-- digitalOutput momentary -->

            <Field id="momentary" type="checkbox" defaultValue="false">
                <Label>Momentary Turn-on:</Label>
            </Field>

            <Field id="turnOffDelay" type="textfield" defaultValue="0"
                   visibleBindingId="momentary" visibleBindingValue="true">
                <Label>Turn-off Delay (0-10 seconds):</Label>
            </Field>

            <Field id="zzDelayLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="momentary" visibleBindingValue="true">
                <Label>A turn-off delay of 0 seconds results in an actual delay of about 0.25 seconds.</Label>
            </Field>


            <!-- digitalOutput pwm -->

            <Field id="pwm" type="checkbox" defaultValue="false"
                   visibleBindingId="ioDevType" visibleBindingValue="pigpio">
                <Label>Pulse Width Modulation (PWM):</Label>
            </Field>

            <Field id="frequency" type="textfield" defaultValue="100"
                   visibleBindingId="pwm" visibleBindingValue="true">
                <Label>PWM Frequency (1-8000 Hertz):</Label>
            </Field>

            <Field id="zzFrequencyLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="pwm" visibleBindingValue="true">
                <Label>The frequency actually used will be one of 16 discrete values that is closest to the frequency specified.  See the pigpio library documentation.</Label>
            </Field>

            <Field id="dutyCycle" type="textfield" defaultValue="50"
                   visibleBindingId="pwm" visibleBindingValue="true">
                <Label>PWM Duty Cycle (0-100 percent):</Label>
            </Field>

            <!-- digitalOutput bitRate -->

            <Field id="bitRate" type="textfield" defaultValue="2000"
                   visibleBindingId="ioDevType" visibleBindingValue="(MCP23S08, MCP23S17)">
                <Label>SPI Bit Rate (100-10000 kb/s):</Label>
            </Field>

            <Field id="zzBitRateLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>SPI bus data transfer rate for this device.  The bit rate in kb/s is usually equal to the SPI clock rate in kHz.</Label>
            </Field>


            <!-- ############      Digital Output Device       ############ -->
            <!-- ############      5. Polling and Logging      ############ -->


            <!-- digitalOutput loggingSeparator -->

            <Field id="zzLoggingSeparator" type="separator"> </Field>

            <Field id="zzLoggingTitle" type="label" alignText="center">
                <Label>Select Logging Options</Label>
            </Field>


            <!-- digitalOutput polling -->

            <Field id="polling" type="checkbox" defaultValue="false">
                <Label>Enable Output Logging:</Label>
            </Field>

            <Field id="zzPollingLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true">
                <Label>Log the output state at regular intervals.</Label>
            </Field>

            <Field id="pollingInterval" type="textfield" defaultValue="10"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Logging Interval (seconds):</Label>
            </Field>

            <Field id="zzPollingIntervalLabel" type="label" fontSize="small"
                   fontColor="darkgray" alignWithControl="true"
                   visibleBindingId="polling" visibleBindingValue="true">
                <Label>Setting the interval to 0 logs the output state in each pass through the run loop.  The actual logging interval depends on the run loop time.</Label>
            </Field>


            <!-- digitalOutput logAll -->

            <Field id="logAll" type="checkbox" defaultValue="true"
                   hidden="true"> </Field>


        </ConfigUI>


    </Device>


</Devices>

